## Distro

Fedora 31


## GSSAPI Impl

Kerberos 5 release 1.18.1 with gss-ntlmssp 0.9.0


## Connection Info:

Connecting to host using FQDN with a valid SPN. Using explicit credentials with the NTLM OID.


## Notes

Just a typical NTLM auth exchange, nothing special


## Tokens

```yaml
MessageType: NtlmNegotiate (1)
Signature: "NTLMSSP\0"
Data:
  NegotiateFlagsRaw: 3758654007
  NegotiateFlags:
  - NTLMSSP_NEGOTIATE_56 (2147483648)
  - NTLMSSP_NEGOTIATE_KEY_EXCH (1073741824)
  - NTLMSSP_NEGOTIATE_128 (536870912)
  - NTLMSSP_NEGOTIATE_EXTENDED_SESSIONSECURITY (524288)
  - NTLMSSP_NEGOTIATE_ALWAYS_SIGN (32768)
  - NTLMSSP_NEGOTIATE_NTLM (512)
  - NTLMSSP_NEGOTIATE_SEAL (32)
  - NTLMSSP_NEGOTIATE_SIGN (16)
  - NTLMSSP_REQUEST_TARGET (4)
  - NTLMSSP_NEGOTIATE_OEM (2)
  - NTLMSSP_NEGOTIATE_UNICODE (1)
  DomainName:
  Workstation:
  Version:
RawData: 4E544C4D5353500001000000378208E000000000000000000000000000000000
```

```yaml
MessageType: NtlmChallenge (2)
Signature: "NTLMSSP\0"
Data:
  NegotiateFlagsRaw: 3800662581
  NegotiateFlags:
  - NTLMSSP_NEGOTIATE_56 (2147483648)
  - NTLMSSP_NEGOTIATE_KEY_EXCH (1073741824)
  - NTLMSSP_NEGOTIATE_128 (536870912)
  - NTLMSSP_NEGOTIATE_VERSION (33554432)
  - NTLMSSP_NEGOTIATE_TARGET_INFO (8388608)
  - NTLMSSP_NEGOTIATE_EXTENDED_SESSIONSECURITY (524288)
  - NTLMSSP_TARGET_TYPE_DOMAIN (65536)
  - NTLMSSP_NEGOTIATE_ALWAYS_SIGN (32768)
  - NTLMSSP_NEGOTIATE_NTLM (512)
  - NTLMSSP_NEGOTIATE_SEAL (32)
  - NTLMSSP_NEGOTIATE_SIGN (16)
  - NTLMSSP_REQUEST_TARGET (4)
  - NTLMSSP_NEGOTIATE_UNICODE (1)
  TargetName: DOMAIN
  ServerChallenge: E4101014CF8A90BE
  Reserved: '0000000000000000'
  TargetInfo:
  - AvId: MSV_AV_NB_DOMAIN_NAME (2)
    Value: DOMAIN
  - AvId: MSV_AV_NB_COMPUTER_NAME (1)
    Value: DC01
  - AvId: MSV_AV_DNS_DOMAIN_NAME (4)
    Value: domain.local
  - AvId: MSV_AV_DNS_COMPUTER_NAME (3)
    Value: DC01.domain.local
  - AvId: MSV_AV_DNS_TREE_NAME (5)
    Value: domain.local
  - AvId: MSV_AV_TIMESTAMP (7)
    Value: '2020-04-30T02:46:22.414079'
  - AvId: MSV_AV_EOL (0)
    Value:
  Version:
    Major: 10
    Minor: 0
    Build: 14393
    NTLMRevision: 15
RawData: 4E544C4D53535000020000000C000C0038000000358289E2E4101014CF8A90BE00000000000000008A008A00440000000A0039380000000F44004F004D00410049004E0002000C0044004F004D00410049004E000100080044004300300031000400180064006F006D00610069006E002E006C006F00630061006C000300220044004300300031002E0064006F006D00610069006E002E006C006F00630061006C000500180064006F006D00610069006E002E006C006F00630061006C0007000800F8819288991ED60100000000
```

```yaml
MessageType: NtlmAuthenticate (3)
Signature: "NTLMSSP\0"
Data:
  NegotiateFlagsRaw: 3800662581
  NegotiateFlags:
  - NTLMSSP_NEGOTIATE_56 (2147483648)
  - NTLMSSP_NEGOTIATE_KEY_EXCH (1073741824)
  - NTLMSSP_NEGOTIATE_128 (536870912)
  - NTLMSSP_NEGOTIATE_VERSION (33554432)
  - NTLMSSP_NEGOTIATE_TARGET_INFO (8388608)
  - NTLMSSP_NEGOTIATE_EXTENDED_SESSIONSECURITY (524288)
  - NTLMSSP_TARGET_TYPE_DOMAIN (65536)
  - NTLMSSP_NEGOTIATE_ALWAYS_SIGN (32768)
  - NTLMSSP_NEGOTIATE_NTLM (512)
  - NTLMSSP_NEGOTIATE_SEAL (32)
  - NTLMSSP_NEGOTIATE_SIGN (16)
  - NTLMSSP_REQUEST_TARGET (4)
  - NTLMSSP_NEGOTIATE_UNICODE (1)
  LmChallengeResponse:
  NtChallengeResponse:
    ResponseType: NTLMv2
    NTProofStr:
    - C543CC0D1A0FBD9EC05E1AAB0771B124
    ClientChallenge:
      RespType: 1
      HiRespType: 1
      Reserved1: 0
      Reserved2: 0
      TimeStamp: '2020-04-30T02:46:22.414079'
      ChallengeFromClient: DC5A7473AC5672FC
      Reserved3: 0
      AvPairs:
      - AvId: MSV_AV_NB_COMPUTER_NAME (1)
        Value: DC01
      - AvId: MSV_AV_NB_DOMAIN_NAME (2)
        Value: DOMAIN
      - AvId: MSV_AV_DNS_COMPUTER_NAME (3)
        Value: DC01.domain.local
      - AvId: MSV_AV_DNS_DOMAIN_NAME (4)
        Value: domain.local
      - AvId: MSV_AV_DNS_TREE_NAME (5)
        Value: domain.local
      - AvId: MSV_AV_FLAGS (6)
        Value: []
      - AvId: MSV_AV_TIMESTAMP (7)
        Value: '2020-04-30T02:46:22.414079'
      - AvId: MSV_AV_TARGET_NAME (9)
        Value: dc01.domain.local
      - AvId: MSV_AV_CHANNEL_BINDINGS (10)
        Value: '00000000000000000000000000000000'
      - AvId: MSV_AV_EOL (0)
        Value:
      Reserved4: 0
  DomainName:
  UserName: vagrant-domain@DOMAIN.LOCAL
  Workstation: JBOREAN-LINUX
  EncryptedRandomSessionKey: 3765D5AFD13EC3A6C97C0726CE9F30C9
  Version:
    Major: 6
    Minor: 2
    Build: 0
    NTLMRevision: 15
  MIC: C543CC0D1A0FBD9EC05E1AAB0771B124
  SessionKey: Failed to derive
RawData: 4E544C4D53535000030000000000000048000000FC00FC0048000000000000000000000036003600440100001A001A007A0100001000100094010000358289E2060200000000000FC543CC0D1A0FBD9EC05E1AAB0771B1240101000000000000F8819288991ED601DC5A7473AC5672FC0000000001000800440043003000310002000C0044004F004D00410049004E000300220044004300300031002E0064006F006D00610069006E002E006C006F00630061006C000400180064006F006D00610069006E002E006C006F00630061006C000500180064006F006D00610069006E002E006C006F00630061006C00060004000000000007000800F8819288991ED6010900220064006300300031002E0064006F006D00610069006E002E006C006F00630061006C000A001000000000000000000000000000000000000000000000000000760061006700720061006E0074002D0064006F006D00610069006E00400044004F004D00410049004E002E004C004F00430041004C004A0042004F005200450041004E002D004C0049004E00550058003765D5AFD13EC3A6C97C0726CE9F30C9
```